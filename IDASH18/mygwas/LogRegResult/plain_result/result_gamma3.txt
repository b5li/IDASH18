SB196372:mygwas mkim10$ make testlogreg
g++ -std=c++11 -O2 -I/usr/local/include -pthread mainLogReg.cpp libHEGWAS.a -o foo -L../lib -L/usr/local/lib -lHEAAN -lntl -lgmp -lm
./foo "idashdata/covariates.txt" "idashdata/snpMat.txt" 

+------------------------------------+
|    1. Read the covariates & SNP    |
+------------------------------------+
(sampleDim, factorDim, nsnp): (245,4,10643)
+------------------------------------+
|       2. Pre-training / cov        |
+------------------------------------+
(IPmin, IPmax) = (0,0)
0: (gamma = 0.0122449 : w = [0.177551,0.0398335,0.0389901,0.0788586], v = [0.00179308,0.000402278,0.00039376,0.000796392]
Correctness: 100 %.
n_test_yi = 0 : cannot compute AUC
Logistic regression with covariates (using NLGD) / niter = 1, deg(sig) = 3 / , Correctness: 100 %, AUC: 0
+------------------------------------+
|         3. Training / snps         |
+------------------------------------+
(IPmin, IPmax) = (0.195091,0.307421)
wData: [0.177551, 0.0398335, 0.0389901, 0.0788586]
p[i]: [0.546104, 0.543419, 0.538046, 0.534846, 0.536947, 0.539004, 0.536856, 0.536932, 0.533515, 0.533265]
wvec: [0.247874, 0.248115, 0.248553, 0.248786, 0.248635, 0.248479, 0.248642, 0.248636, 0.248877, 0.248893]
zvec: [2.13857, -1.90071, 2.11219, -1.91757, -1.9133, -1.90921, -1.91349, -1.91333, -1.92032, 2.09694]
 (X^T * W * X): 
[60.91597886	22.68958591	23.67691124	29.44052569]
[22.68958591	9.863027525	8.803912813	10.93353856]
[23.67691124	8.803912813	10.30589392	12.00174685]
[29.44052569	10.93353856	12.00174685	15.283486]
 (X^T * W * X)^-1: 
[0.3657653852	-0.2742716015	-0.1637299696	-0.3797903463]
[-0.2742716015	0.7088345717	-0.001744622289	0.0226105825]
[-0.1637299696	-0.001744622289	1.238901009	-0.6562380477]
[-0.3797903463	0.0226105825	-0.6562380477	1.296171351]
det = 73.17916855
================================
 1/2 * X^T * W * X: 
[30.45798943	11.34479295	11.83845562	14.72026285]
[11.34479295	4.931513763	4.401956407	5.466769281]
[11.83845562	4.401956407	5.152946961	6.000873425]
[14.72026285	5.466769281	6.000873425	7.641742999]
 (1/2 X^T * W * X)^-1: 
[0.7315307703	-0.548543203	-0.3274599392	-0.7595806926]
[-0.548543203	1.417669143	-0.003489244579	0.04522116499]
[-0.3274599392	-0.003489244579	2.477802018	-1.312476095]
[-0.7595806926	0.04522116499	-1.312476095	2.592342702]
4 * det = 9.147396069
adj = 
[3.345800846	-2.508870969	-1.49770288	-3.474092721]
[-2.508870969	6.483990574	-0.01595875107	0.2068279534]
[-1.49770288	-0.01595875107	11.33271822	-6.002869338]
[-3.474092721	0.2068279534	-6.002869338	11.85659272]
Zt * W * X:-8.565250074,-1.021801443,-0.8436836503,-3.531362493,


+------------------------------------+
|       2. Pre-training / cov        |
+------------------------------------+
(IPmin, IPmax) = (0,0)
0: (gamma = 0.0122449 : w = [0.177551,0.0398335,0.0389901,0.0788586], v = [0.00179308,0.000402278,0.00039376,0.000796392]
(IPmin, IPmax) = (-0.00293005,0.00310464)
1: (gamma = 0.0122449 : w = [0.178227,0.0398156,0.0389431,0.0791072], v = [0.178227,0.0398156,0.0389431,0.0791072]
Correctness: 100 %.
n_test_yi = 0 : cannot compute AUC
Logistic regression with covariates (using NLGD) / niter = 2, deg(sig) = 3 / , Correctness: 100 %, AUC: 0
+------------------------------------+
|         3. Training / snps         |
+------------------------------------+
(IPmin, IPmax) = (0.195754,0.308299)
wData: [0.178227, 0.0398156, 0.0389431, 0.0791072]
p[i]: [0.546235, 0.543541, 0.538168, 0.534966, 0.537067, 0.539121, 0.536971, 0.537052, 0.533633, 0.533377]
wvec: [0.247862, 0.248104, 0.248543, 0.248777, 0.248626, 0.24847, 0.248633, 0.248627, 0.248869, 0.248886]
zvec: [2.13901, -1.90048, 2.11258, -1.91733, -1.91306, -1.90898, -1.91326, -1.91309, -1.92007, 2.0973]
 (X^T * W * X): 
[60.91388587	22.68880019	23.67608172	29.43948908]
[22.68880019	9.86268342	8.803601405	10.9331498]
[23.67608172	8.803601405	10.30552736	12.00131662]
[29.43948908	10.9331498	12.00131662	15.28293637]
 (X^T * W * X)^-1: 
[0.3657778528	-0.2742813624	-0.1637356616	-0.3798033457]
[-0.2742813624	0.7088592813	-0.001744548105	0.02261184178]
[-0.1637356616	-0.001744548105	1.238943097	-0.6562600607]
[-0.3798033457	0.02261184178	-0.6562600607	1.296215733]
det = 73.16908465
================================
 1/2 * X^T * W * X: 
[30.45694293	11.3444001	11.83804086	14.71974454]
[11.3444001	4.93134171	4.401800702	5.466574898]
[11.83804086	4.401800702	5.152763681	6.000658309]
[14.71974454	5.466574898	6.000658309	7.641468183]
 (1/2 X^T * W * X)^-1: 
[0.7315557057	-0.5485627248	-0.3274713233	-0.7596066915]
[-0.5485627248	1.417718563	-0.003489096211	0.04522368357]
[-0.3274713233	-0.003489096211	2.477886193	-1.312520121]
[-0.7596066915	0.04522368357	-1.312520121	2.592431467]
4 * det = 9.146135582
adj = 
[3.345453835	-2.508614528	-1.497548561	-3.473732895]
[-2.508614528	6.483323095	-0.0159558735	0.2068109707]
[-1.497548561	-0.0159558735	11.33154154	-6.002243492]
[-3.473732895	0.2068109707	-6.002243492	11.85536484]
Zt * W * X:-8.547106637,-1.01506063,-0.836605097,-3.522511046,


+------------------------------------+
|       2. Pre-training / cov        |
+------------------------------------+
(IPmin, IPmax) = (0,0)
0: (gamma = 0.0122449 : w = [0.177551,0.0398335,0.0389901,0.0788586], v = [0.00179308,0.000402278,0.00039376,0.000796392]
(IPmin, IPmax) = (-0.00293005,0.00310464)
1: (gamma = 0.0122449 : w = [0.178227,0.0398156,0.0389431,0.0791072], v = [0.178227,0.0398156,0.0389431,0.0791072]
(IPmin, IPmax) = (-0.290961,0.308299)
2: (gamma = 0.0122449 : w = [0.244865,0.037941,0.0341777,0.103587], v = [0.263643,0.0374128,0.0328349,0.110485]
Correctness: 100 %.
n_test_yi = 0 : cannot compute AUC
Logistic regression with covariates (using NLGD) / niter = 3, deg(sig) = 3 / , Correctness: 100 %, AUC: 0
+------------------------------------+
|         3. Training / snps         |
+------------------------------------+
(IPmin, IPmax) = (0.261073,0.394745)
wData: [0.244865, 0.037941, 0.0341777, 0.103587]
p[i]: [0.559161, 0.555472, 0.550189, 0.54671, 0.548802, 0.550625, 0.548339, 0.548887, 0.545279, 0.544477]
wvec: [0.2465, 0.246923, 0.247481, 0.247818, 0.247618, 0.247437, 0.247663, 0.24761, 0.24795, 0.248022]
zvec: [2.18314, -1.87952, 2.15228, -1.89462, -1.89087, -1.88767, -1.89169, -1.89072, -1.89724, 2.13318]
 (X^T * W * X): 
[60.67588692	22.59960127	23.58188949	29.32168095]
[22.59960127	9.823669983	8.768296039	10.88904484]
[23.58188949	8.768296039	10.26396369	11.95248767]
[29.32168095	10.88904484	11.95248767	15.22050703]
 (X^T * W * X)^-1: 
[0.3672010044	-0.2753947206	-0.1643868017	-0.3812838825]
[-0.2753947206	0.7116769622	-0.001731611857	0.02274896953]
[-0.1643868017	-0.001731611857	1.243727467	-0.6587615147]
[-0.3812838825	0.02274896953	-0.6587615147	1.301271281]
det = 72.03105583
================================
 1/2 * X^T * W * X: 
[30.33794346	11.29980063	11.79094474	14.66084047]
[11.29980063	4.911834992	4.384148019	5.444522418]
[11.79094474	4.384148019	5.131981843	5.976243836]
[14.66084047	5.444522418	5.976243836	7.610253517]
 (1/2 X^T * W * X)^-1: 
[0.7344020088	-0.5507894411	-0.3287736033	-0.7625677649]
[-0.5507894411	1.423353924	-0.003463223713	0.04549793907]
[-0.3287736033	-0.003463223713	2.487454934	-1.317523029]
[-0.7625677649	0.04549793907	-1.317523029	2.602542562]
4 * det = 9.003881978
adj = 
[3.306234506	-2.479621561	-1.480119361	-3.433035078]
[-2.479621561	6.407855374	-0.01559122879	0.2048290368]
[-1.480119361	-0.01559122879	11.19837533	-5.93141093]
[-3.433035078	0.2048290368	-5.93141093	11.71649304]
Zt * W * X:-6.784700325,-0.3604029443,-0.1492528965,-2.663026604,
+------------------------------------+
| 4. Quality check  (TP, FP, FN, TN) |
+------------------------------------+
#(GD iter) = 1
vs pt(semi-parallel) = (1,0.00512988,0,0.99487)
vs pt(gold) = 0.967589,0.000873172,0.0324105,0.999127)
=================================
#(GD iter) = 2
vs pt(semi-parallel) = (1,0.00512988,0,0.99487)
vs pt(gold) = 0.967589,0.000873172,0.0324105,0.999127)
=================================
#(GD iter) = 3
vs pt(semi-parallel) = (1,0.00415164,0,0.995848)
vs pt(gold) = 0.961745,0.00087403,0.038255,0.999126)
=================================